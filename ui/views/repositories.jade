extends layout

block content
	h1= title
	p Welcome to #{title}

	div(class="row")
		each repository, i in repositories
			div(class=".col-12 col-sm-12 col-md-6 col-lg-4 col-xl-3")
				div(class="card", style="margin-top: 10px;")
					div(class="card-body")
						h4(class="card-title") #{repository.name}
						h6(class="card-subtitle mb-2 text-muted") #{repository.owner}

						form
							div(class="form-group")
								div(class="form-check")
									label(class="form-check-label")
										input(class="form-check-input", id="vacationMode#{repository.name}", type="checkbox" value="")
										| Vacation Mode

							div(class="form-group")
								label(for="exampleFormControlTextarea1") Pull Request Comment
								textarea(class="form-control", id="comment#{repository.name}", rows="3")

							button(class="btn btn-primary", onclick="enable('#{repository.owner}', '#{repository.name}');") Save
					div(class="card-footer text-muted")
						| 2 days ago

	script.
		var socket = io.connect('https://github-vacation.wedeploy.io');
		function enable(owner, repo) {
			socket.emit(
				'vacation',
				{
					'owner': owner,
					'repo': repo,
					'vacationMode': ($('#vacationMode' + repo).is(":checked")),
					'comment': $('#comment' + repo).val()
				}
			);
		}